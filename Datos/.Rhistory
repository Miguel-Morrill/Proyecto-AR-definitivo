rend_T <- merge.xts(rendimiento, rend_LACOMERUBC, rend_RA, rend_GFINBURO, rend_GFNORTEO,  rend_AMX, rend_mercado)
plot(rend_T, main = "Rendimientos de los Activos + IPC")+
legend("bottom", legend = c("SITESB-1.MX", "LACOMERUBC.MX", "RA.MX", "GFINBURO.MX",  "GFNORTEO.MX", "AMX", "MXX"))
rend_T <- merge.xts(rendimiento, rend_LACOMERUBC, rend_RA, rend_GFINBURO, rend_GFNORTEO,  rend_AMX, rend_mercado)
plot(rend_T, main = "Rendimientos de los Activos + IPC") %>%
legend("bottom", legend = c("SITESB-1.MX", "LACOMERUBC.MX", "RA.MX", "GFINBURO.MX",  "GFNORTEO.MX", "AMX", "MXX"), col=1:2, pch = 1:2)
rend_T <- merge.xts(rendimiento, rend_LACOMERUBC, rend_RA, rend_GFINBURO, rend_GFNORTEO,  rend_AMX, rend_mercado)
plot(rend_T, main = "Rendimientos de los Activos + IPC") %>%
legend("bottom", legend = c("SITESB-1.MX", "LACOMERUBC.MX", "RA.MX", "GFINBURO.MX",  "GFNORTEO.MX", "AMX", "MXX"))
rend_T <- merge.xts(rendimiento, rend_LACOMERUBC, rend_RA, rend_GFINBURO, rend_GFNORTEO,  rend_AMX, rend_mercado)
plot(rend_T, main = "Rendimientos de los Activos + IPC") %>%
legend(x=3.5,y=14,"bottom", legend = c("SITESB-1.MX", "LACOMERUBC.MX", "RA.MX", "GFINBURO.MX",  "GFNORTEO.MX", "AMX", "MXX"))
rend_T <- merge.xts(rendimiento, rend_LACOMERUBC, rend_RA, rend_GFINBURO, rend_GFNORTEO,  rend_AMX, rend_mercado)
plot(rend_T, main = "Rendimientos de los Activos + IPC") %>%
legend(x=3.5,y=14,"bottom", legend = c("SITESB-1.MX", "LACOMERUBC.MX", "RA.MX", "GFINBURO.MX",  "GFNORTEO.MX", "AMX", "MXX", col=(2,4)))
rend_T <- merge.xts(rendimiento, rend_LACOMERUBC, rend_RA, rend_GFINBURO, rend_GFNORTEO,  rend_AMX, rend_mercado)
plot(rend_T, main = "Rendimientos de los Activos + IPC")
legend(x=3.5,y=14,"bottom", legend = c("SITESB-1.MX", "LACOMERUBC.MX", "RA.MX", "GFINBURO.MX",  "GFNORTEO.MX", "AMX", "MXX", col=(2,4)))
rend_T <- merge.xts(rendimiento, rend_LACOMERUBC, rend_RA, rend_GFINBURO, rend_GFNORTEO,  rend_AMX, rend_mercado)
plot(rend_T, main = "Rendimientos de los Activos + IPC")
legend(x=3.5,y=14,"bottom", legend = c("SITESB-1.MX", "LACOMERUBC.MX", "RA.MX", "GFINBURO.MX",  "GFNORTEO.MX", "AMX", "MXX"))
rend_T <- merge.xts(rendimiento, rend_LACOMERUBC, rend_RA, rend_GFINBURO, rend_GFNORTEO,  rend_AMX, rend_mercado)
plot(rend_T, main = "Rendimientos de los Activos + IPC")
legend("bottom", legend = c("SITESB-1.MX", "LACOMERUBC.MX", "RA.MX", "GFINBURO.MX",  "GFNORTEO.MX", "AMX", "MXX"))
rend_T <- merge.xts(rendimiento, rend_LACOMERUBC, rend_RA, rend_GFINBURO, rend_GFNORTEO,  rend_AMX, rend_mercado)
plot(rend_T, main = "Rendimientos de los Activos + IPC")
legend(x=3.5,y=14,"bottom", legend = c("SITESB-1.MX", "LACOMERUBC.MX", "RA.MX", "GFINBURO.MX",  "GFNORTEO.MX", "AMX", "MXX"))
rend_T <- merge.xts(rendimiento, rend_LACOMERUBC, rend_RA, rend_GFINBURO, rend_GFNORTEO,  rend_AMX, rend_mercado)
plot(rend_T, main = "Rendimientos de los Activos + IPC")
legend(x=3.5,y=14,border="bottom", legend = c("SITESB-1.MX", "LACOMERUBC.MX", "RA.MX", "GFINBURO.MX",  "GFNORTEO.MX", "AMX", "MXX"))
rend_T <- merge.xts(rendimiento, rend_LACOMERUBC, rend_RA, rend_GFINBURO, rend_GFNORTEO,  rend_AMX, rend_mercado)
plot(rend_T, main = "Rendimientos de los Activos + IPC")
legend(x=3.5,y=14, legend = c("SITESB-1.MX", "LACOMERUBC.MX", "RA.MX", "GFINBURO.MX",  "GFNORTEO.MX", "AMX", "MXX"))
rend_T <- merge.xts(rendimiento, rend_LACOMERUBC, rend_RA, rend_GFINBURO, rend_GFNORTEO,  rend_AMX, rend_mercado)
plot(rend_T, main = "Rendimientos de los Activos + IPC") %>%
legend(x=3.5,y=14, legend = c("SITESB-1.MX", "LACOMERUBC.MX", "RA.MX", "GFINBURO.MX",  "GFNORTEO.MX", "AMX", "MXX"))
rend_T <- merge.xts(rendimiento, rend_LACOMERUBC, rend_RA, rend_GFINBURO, rend_GFNORTEO,  rend_AMX, rend_mercado)
plot(rend_T, main = "Rendimientos de los Activos + IPC") %<%
legend(x=3.5,y=14, legend = c("SITESB-1.MX", "LACOMERUBC.MX", "RA.MX", "GFINBURO.MX",  "GFNORTEO.MX", "AMX", "MXX"))
rend_T <- merge.xts(rendimiento, rend_LACOMERUBC, rend_RA, rend_GFINBURO, rend_GFNORTEO,  rend_AMX, rend_mercado)
plot(rend_T, main = "Rendimientos de los Activos + IPC") %>%
legend(x=3.5,y=14, legend = c("SITESB-1.MX", "LACOMERUBC.MX", "RA.MX", "GFINBURO.MX",  "GFNORTEO.MX", "AMX", "MXX"))
rend_T <- merge.xts(rendimiento, rend_LACOMERUBC, rend_RA, rend_GFINBURO, rend_GFNORTEO,  rend_AMX, rend_mercado)
plot(rend_T, main = "Rendimientos de los Activos + IPC") %>%
legend("topleft", legend = c("SITESB-1.MX", "LACOMERUBC.MX", "RA.MX", "GFINBURO.MX",  "GFNORTEO.MX", "AMX", "MXX"))
rend_T <- merge.xts(rendimiento, rend_LACOMERUBC, rend_RA, rend_GFINBURO, rend_GFNORTEO,  rend_AMX, rend_mercado)
plot(rend_T, main = "Rendimientos de los Activos + IPC")
legend("topleft", legend = c("SITESB-1.MX", "LACOMERUBC.MX", "RA.MX", "GFINBURO.MX",  "GFNORTEO.MX", "AMX", "MXX"))
rend_T <- merge.xts(rendimiento, rend_LACOMERUBC, rend_RA, rend_GFINBURO, rend_GFNORTEO,  rend_AMX, rend_mercado)
plot(rend_T, main = "Rendimientos de los Activos + IPC")
legend("topright", legend = c("SITESB-1.MX", "LACOMERUBC.MX", "RA.MX", "GFINBURO.MX",  "GFNORTEO.MX", "AMX", "MXX"))
rend_T <- merge.xts(rendimiento, rend_LACOMERUBC, rend_RA, rend_GFINBURO, rend_GFNORTEO,  rend_AMX, rend_mercado)
plot(rend_T, main = "Rendimientos de los Activos + IPC")
legend("topright", legend = c("SITESB-1.MX", "LACOMERUBC.MX", "RA.MX", "GFINBURO.MX",  "GFNORTEO.MX", "AMX", "MXX", merge=TRUE))
rend_T <- merge.xts(rendimiento, rend_LACOMERUBC, rend_RA, rend_GFINBURO, rend_GFNORTEO,  rend_AMX, rend_mercado)
plot(rend_T, main = "Rendimientos de los Activos + IPC")
legend("topright", merge=TRUE))
rend_T <- merge.xts(rendimiento, rend_LACOMERUBC, rend_RA, rend_GFINBURO, rend_GFNORTEO,  rend_AMX, rend_mercado)
plot(rend_T, main = "Rendimientos de los Activos + IPC")
legend("topright", merge=TRUE)
rend_T <- merge.xts(rendimiento, rend_LACOMERUBC, rend_RA, rend_GFINBURO, rend_GFNORTEO,  rend_AMX, rend_mercado)
plot(rend_T, main = "Rendimientos de los Activos + IPC")
legend("topright", legend = c("SITESB-1.MX", "LACOMERUBC.MX", "RA.MX", "GFINBURO.MX",  "GFNORTEO.MX", "AMX", "MXX"), merge=TRUE)
rend_T <- merge.xts(rendimiento, rend_LACOMERUBC, rend_RA, rend_GFINBURO, rend_GFNORTEO,  rend_AMX, rend_mercado)
plot(rend_T, main = "Rendimientos de los Activos + IPC")
legend("bottom", legend = c("SITESB-1.MX", "LACOMERUBC.MX", "RA.MX", "GFINBURO.MX",  "GFNORTEO.MX", "AMX", "MXX"), merge=TRUE)
list <- lapply(na.omit(tickers), function(x) Cl(get(x)))
precio.cierre <- do.call(merge,list)
retornos <- data.frame(apply(precio.cierre, 2, function(x) Delt(x, type = "log")), fecha = index(na.omit(precio.cierre)))
list <- lapply(na.omit(tickers), function(x) Cl(get(x)))
precio.cierre <- do.call(merge,list)
retornos <- data.frame(apply(precio.cierre, 2, function(x) Delt(x, type = "log")), fecha = index(na.omit(precio.cierre)))
list <- lapply(na.omit(tickers), function(x) Cl(get(x)))
precio.cierre <- do.call(merge,list)
retornos <- data.frame(apply(precio.cierre, 2, function(x) Delt(x, type = "log")), fecha = index(precio.cierre))
reshape <- melt(retornos, id.vars = "fecha")
g2 <- ggplot(reshape) + geom_line(mapping = aes(fecha,value, color = variable))
g2 <- g2 + labs(title = "Retornos", subtitle = "SITES, WALMART")
g2 <- g2 + theme_bw() + xlab("Fecha") + ylab("Retornos")
g2 <- g2 + scale_color_manual("Tickers", values = c("green", "yellow", "orange", "red", "blue", "purple", "pink"))
g2 <- g2 + theme(legend.position = "bottom")
g2
list <- lapply(na.fill(tickers), function(x) Cl(get(x)))
list <- lapply((tickers), function(x) Cl(get(x)))
precio.cierre <- do.call(merge,list)
retornos <- data.frame(apply(precio.cierre, 2, function(x) Delt(x, type = "log")), fecha = index(precio.cierre))
reshape <- melt(retornos, id.vars = "fecha")
g2 <- ggplot(reshape) + geom_line(mapping = aes(fecha,value, color = variable))
g2 <- g2 + labs(title = "Retornos", subtitle = "SITES, WALMART")
g2 <- g2 + theme_bw() + xlab("Fecha") + ylab("Retornos")
g2 <- g2 + scale_color_manual("Tickers", values = c("green", "yellow", "orange", "red", "blue", "purple", "pink"))
g2 <- g2 + theme(legend.position = "bottom")
g2
tickers <- c("SITESB-1.MX", "LACOMERUBC.MX", "RA.MX", "GFINBURO.MX",  "GFNORTEO.MX", "AMX", "MXX")
getSymbols(na.fill(tickers), from = "2016-01-02", to = today(), warnings = FALSE)
tickers <- c("SITESB-1.MX", "LACOMERUBC.MX", "RA.MX", "GFINBURO.MX",  "GFNORTEO.MX", "AMX", "MXX")
getSymbols(na.omit(tickers), from = "2016-01-02", to = today(), warnings = FALSE)
list <- lapply((tickers), function(x) Cl(get(x)))
precio.cierre <- do.call(merge,list)
retornos <- data.frame(apply(precio.cierre, 2, function(x) Delt(x, type = "log")), fecha = index(precio.cierre))
reshape <- melt(retornos, id.vars = "fecha")
g2 <- ggplot(reshape) + geom_line(mapping = aes(fecha,value, color = variable))
g2 <- g2 + labs(title = "Retornos", subtitle = "SITES, WALMART")
g2 <- g2 + theme_bw() + xlab("Fecha") + ylab("Retornos")
g2 <- g2 + scale_color_manual("Tickers", values = c("green", "yellow", "orange", "red", "blue", "purple", "pink"))
g2 <- g2 + theme(legend.position = "bottom")
g2
list <- lapply((tickers), function(x) Cl(get(x)))
precio.cierre <- do.call(merge,list)
retornos <- data.frame(apply(precio.cierre, 2, function(x) Delt(x, type = "log")), fecha = index(precio.cierre))
reshape <- melt(retornos, id.vars = "fecha")
g2 <- ggplot(na.fill(reshape)) + geom_line(mapping = aes(fecha,value, color = variable))
tickers <- c("SITESB-1.MX", "LACOMERUBC.MX", "RA.MX", "GFINBURO.MX",  "GFNORTEO.MX", "AMX", "MXX")
getSymbols(tickers, from = "2016-01-02", to = today(), warnings = FALSE)
list <- lapply((tickers), function(x) Cl(get(x)))
precio.cierre <- do.call(merge,list)
retornos <- data.frame(apply(precio.cierre, 2, function(x) Delt(x, type = "log")), fecha = index(precio.cierre))
reshape <- melt(retornos, id.vars = "fecha")
g2 <- ggplot(reshape) + geom_line(mapping = aes(fecha,value, color = variable))
g2 <- g2 + labs(title = "Retornos", subtitle = "SITES, WALMART")
g2 <- g2 + theme_bw() + xlab("Fecha") + ylab("Retornos")
g2 <- g2 + scale_color_manual("Tickers", values = c("green", "yellow", "orange", "red", "blue", "purple", "pink"))
g2 <- g2 + theme(legend.position = "bottom")
g2
d <- length(rendimiento)
S0 <- as.numeric(precio[d])
S0
n <- 10000
dt <- 10
simula <- tibble(epsilon=rnorm(n),dS=S0*mu_2020*dt+S0*sigma_2020*sqrt(dt)*epsilon)
PE_10 <- S0+mean(simula$dS)
PE_10
Media_DS <- mean(simula$dS)
DeSt_DS <- as.numeric(sqrt(var(simula$dS)))
Z <- qnorm(.975)
P_Sup_10 <- S0+Media_DS+Z*DeSt_DS
P_Inf_10 <- S0+Media_DS-Z*DeSt_DS
P_Sup_10
P_Inf_10
S0
n <- 10000
dt <- 20
simula <- tibble(epsilon=rnorm(n),dS=S0*mu_2020*dt+S0*sigma_2020*sqrt(dt)*epsilon)
PE_20 <- S0+mean(simula$dS)
PE_20
Media_DS <- mean(simula$dS)
DeSt_DS <- as.numeric(sqrt(var(simula$dS)))
Z <- qnorm(.975)
P_Sup_20 <- S0+Media_DS+Z*DeSt_DS
P_Inf_20 <- S0+Media_DS-Z*DeSt_DS
P_Sup_20
P_Inf_20
S0
n <- 10000
dt <- 40
simula <- tibble(epsilon=rnorm(n),dS=S0*mu_2020*dt+S0*sigma_2020*sqrt(dt)*epsilon)
PE_40 <- S0+mean(simula$dS)
PE_40
Media_DS <- mean(simula$dS)
DeSt_DS <- as.numeric(sqrt(var(simula$dS)))
Z <- qnorm(.975)
P_Sup_40 <- S0+Media_DS+Z*DeSt_DS
P_Inf_40 <- S0+Media_DS-Z*DeSt_DS
print(P_Sup_40)
P_Sup_40
print(P_Inf_40)
print(S0)
S0
resumen <- tibble(Diez <- c(PE_10,P_Sup_10,P_Inf_10),
Veinte <- c(PE_20,P_Sup_20,P_Inf_20),
Cuarenta <- c(PE_40,P_Sup_40,P_Inf_40),
.name_repair = ~ c("Diez días","Veinte días","Cuarenta días"))
resumen <- as.data.frame(resumen)
rownames(resumen) <- c("Valor esperado","Superior 95%","Inferior 95%")
resumen
mu_2020_a <- mean(rendimiento[year(rendimiento)==2020])*252
sigma_2020_a <- sqrt(var(rendimiento[year(rendimiento)==2020])*252)
print(mu_2020_a)
print("rendimiento esperado anual")
print(sigma_2020_a)
print("volatilidad anual")
d <- length(rendimiento)
lns0 <- as.numeric(log(precio[d]))
lns0
n <- 10000
dt <- 1/4
simula2 <- tibble(epsilon=rnorm(n),lnS=(mu_2020_a-(1/2)*sigma_2020_a**2)*dt+sigma_2020_a*sqrt(dt)*epsilon)
PE_3 <- lns0+mean(simula2$lnS)
PE_3
Media_DS <- mean(simula2$lnS)
DeSt_DS <- as.numeric(sqrt(var(simula2$lnS)))
Z <- qnorm(.975)
P_Sup_3 <- lns0+Media_DS+Z*DeSt_DS
P_Inf_3 <- lns0+Media_DS-Z*DeSt_DS
P_Sup_3
P_Inf_3
lns0
n <- 10000
dt <- 1/2
simula2 <- tibble(epsilon=rnorm(n),lnS=(mu_2020_a-(1/2)*sigma_2020_a**2)*dt+sigma_2020_a*sqrt(dt)*epsilon)
PE_6 <- lns0+mean(simula2$lnS)
PE_6
Media_DS <- mean(simula2$lnS)
DeSt_DS <- as.numeric(sqrt(var(simula2$lnS)))
Z <- qnorm(.975)
P_Sup_6 <- lns0+Media_DS+Z*DeSt_DS
P_Inf_6 <- lns0+Media_DS-Z*DeSt_DS
P_Sup_6
P_Inf_6
lns0
n <- 10000
dt <- 3/4
simula2 <- tibble(epsilon=rnorm(n),lnS=(mu_2020_a-(1/2)*sigma_2020_a**2)*dt+sigma_2020_a*sqrt(dt)*epsilon)
PE_9 <- lns0+mean(simula2$lnS)
PE_9
Media_DS <- mean(simula2$lnS)
DeSt_DS <- as.numeric(sqrt(var(simula2$lnS)))
Z <- qnorm(.975)
P_Sup_9 <- lns0+Media_DS+Z*DeSt_DS
P_Inf_9 <- lns0+Media_DS-Z*DeSt_DS
P_Sup_9
P_Inf_9
lns0
n <- 10000
dt <- 1
simula2 <- tibble(epsilon=rnorm(n),lnS=(mu_2020_a-(1/2)*sigma_2020_a**2)*dt+sigma_2020_a*sqrt(dt)*epsilon)
PE_12 <- lns0+mean(simula2$lnS)
PE_12
Media_DS <- mean(simula2$lnS)
DeSt_DS <- as.numeric(sqrt(var(simula2$lnS)))
Z <- qnorm(.975)
P_Sup_12 <- lns0+Media_DS+Z*DeSt_DS
P_Inf_12 <- lns0+Media_DS-Z*DeSt_DS
P_Sup_12
P_Inf_12
lns0
resumen <- tibble(Tres <- c(PE_3,P_Sup_3,P_Inf_3),
Seis <- c(PE_6,P_Sup_6,P_Inf_6),
Nueve <- c(PE_9,P_Sup_9,P_Inf_9),
Doce <- c(PE_12,P_Sup_12,P_Inf_12),
.name_repair = ~ c("Tres meses","Seis meses","Nueve meses","Doce meses"))
resumen <- as.data.frame(resumen)
rownames(resumen) <- c("Valor esperado","Superior 95%","Inferior 95%")
resumen
getSymbols("^MXX", from='2016-01-01', to=today(), warnings=FALSE)
rend_mercado <- na.omit(diff(log(MXX$MXX.Adjusted)))
# agregamos na.omit para evitar los datos incompletos
datos_corr <- merge.xts(rend_mercado,rendimiento)
names(datos_corr) <- c('IPC',clave)
chart.Correlation(na.omit(datos_corr))
cor(na.omit(datos_corr))
cov(na.omit(datos_corr))
library(tidyverse)
setwd('C:/Users/theso/OneDrive/Documents/Semestre 6/Analisis de Riesgo/Proyecto-AR-definitivo/Datos')
Emisoras <- read_csv('Emisoras_Completo2.csv')
Emisoras <- as.matrix(Emisoras)
datos2 <- new.env()
n <- nrow(Emisoras)
MAT_COR <- as.data.frame(matrix(0,n,2))
names(MAT_COR) <- c("Emisoras","Correlación")
for (i in 1:n) {
clave2 <- Emisoras[i,1]
getSymbols(clave2, from='2016-01-01', to=today(), warnings = FALSE, env=datos2)
activo2 <- datos2[[clave2]]
precio2 <- activo2[,6]
rend_act2 <- na.omit(diff(log(precio2)))
datos_cor2 <- merge.xts(rendimiento, rend_act2)
#chart.Correlation(na.omit(datos_cor2)) #para que no me haga 100 graficas
m <- cor(na.omit(datos_cor2))
ro <- m[2,1]
MAT_COR[i,1] <- clave2
MAT_COR[i,2] <- ro
}
library(tidyverse)
library(kableExtra)
mas_co <- arrange(MAT_COR,-Correlación)[2:6,]
DF_Emi <- tibble(mas_co)
kable(DF_Emi, caption = "<center>**Activos más Correlacionados**", align = c("c","c"), digits = 6) %>%
kable_classic(full_width=F) %>%
row_spec(0, bold = T) %>% #selecciono la columna 1 en negritas
column_spec(1, bold = T, color = "blue")
getSymbols("LACOMERUBC.MX", from='2016-01-01', to=today(), warnings=FALSE)
rend_LACOMERUBC <- na.omit(diff(log(LACOMERUBC.MX$LACOMERUBC.MX.Adjusted)))
getSymbols("RA.MX", from='2016-01-01', to=today(), warnings=FALSE)
rend_RA <- na.omit(diff(log(RA.MX$RA.MX.Adjusted)))
getSymbols("GFINBURO.MX", from='2016-01-01', to=today(), warnings=FALSE)
rend_GFINBURO <- na.omit(diff(log(GFINBURO.MX$GFINBURO.MX.Adjusted)))
getSymbols("GFNORTEO.MX", from='2016-01-01', to=today(), warnings=FALSE)
rend_GFNORTEO <- na.omit(diff(log(GFNORTEO.MX$GFNORTEO.MX.Adjusted)))
clave7 <- "AMX"
datos7 <- new.env()
getSymbols(clave7, from = "2016-01-01", to = today(), warnings = FALSE, env = datos7)
precio7 <- datos7[[clave7]][,6] #la información en la columna 6, o sea los precios al cierre
names(precio7) <- clave7
rend_AMX <-na.omit(diff(log(precio7)))
chartSeries((rendimiento), name = paste("Rendimiento de SITESB-1.MX"),up.col = "yellow", dn.col = "red")
chartSeries((rend_LACOMERUBC), name = paste("Precio de LACOMERUBC"),up.col = "orange", dn.col = "red")
chartSeries((rend_RA), name = paste("Rendimiento de RA"),up.col = "red", dn.col = "red")
chartSeries((rend_GFINBURO), name = paste("Rendimiento de GFINBURO"),up.col = "blue", dn.col = "red")
chartSeries((rend_GFNORTEO), name = paste("Rendimiento de GFNORTEO"),up.col = "purple", dn.col = "red")
chartSeries((rend_AMX), name = paste("Rendimiento de AMX"),up.col = "pink", dn.col = "red")
chartSeries((rend_mercado), name = paste("Rendimiento de IPC"),up.col = "white", dn.col = "red")
rend_T <- merge.xts(rendimiento, rend_LACOMERUBC, rend_RA, rend_GFINBURO, rend_GFNORTEO,  rend_AMX, rend_mercado)
plot(rend_T, main = "Rendimientos de los Activos + IPC")
legend("bottom", legend = c("SITESB-1.MX", "LACOMERUBC.MX", "RA.MX", "GFINBURO.MX",  "GFNORTEO.MX", "AMX", "MXX"), merge=TRUE)
library(quantmod)
library(PerformanceAnalytics)
library(lubridate)
library(reshape2)
library(ggplot2)
tickers <- c("SITESB-1.MX", "LACOMERUBC.MX", "RA.MX", "GFINBURO.MX",  "GFNORTEO.MX", "AMX", "MXX")
getSymbols(tickers, from = "2016-01-02", to = today(), warnings = FALSE)
list <- lapply((tickers), function(x) Cl(get(x)))
precio.cierre <- do.call(merge,list)
retornos <- data.frame(apply(precio.cierre, 2, function(x) Delt(x, type = "log")), fecha = index(precio.cierre))
reshape <- melt(retornos, id.vars = "fecha")
g2 <- ggplot(reshape) + geom_line(mapping = aes(fecha,value, color = variable))
g2 <- g2 + labs(title = "Retornos", subtitle = "SITES, WALMART")
g2 <- g2 + theme_bw() + xlab("Fecha") + ylab("Retornos")
g2 <- g2 + scale_color_manual("Tickers", values = c("green", "yellow", "orange", "red", "blue", "purple", "pink"))
g2 <- g2 + theme(legend.position = "bottom")
g2
tickers <- c("SITESB-1.MX", "LACOMERUBC.MX", "RA.MX", "GFINBURO.MX",  "GFNORTEO.MX", "AMX")
getSymbols(tickers, from = "2016-01-02", to = today(), warnings = FALSE)
list <- lapply((tickers), function(x) Cl(get(x)))
precio.cierre <- do.call(merge,list)
retornos <- data.frame(apply(precio.cierre, 2, function(x) Delt(x, type = "log")), fecha = index(precio.cierre))
retornos2 <- merge.xts(retornos, rend_mercado)
legend()
legth(rend_mercado)
length(rend_mercado)
length(retornos)
View(retornos)
View(retornos)
View(rend_mercado)
View(rend_mercado)
list <- lapply((tickers), function(x) Cl(get(x)))
precio.cierre <- do.call(merge,list)
retornos <- data.frame(apply(precio.cierre, 2, function(x) Delt(x, type = "log")), fecha = index(precio.cierre))
retornos2 <- merge.xts(retornos, rend_mercado.T)
tickers <- c("SITESB-1.MX", "LACOMERUBC.MX", "RA.MX", "GFINBURO.MX",  "GFNORTEO.MX", "AMX", "MXX")
getSymbols(tickers, from = "2016-01-02", to = today(), warnings = FALSE)
list <- lapply((tickers), function(x) Cl(get(x)))
precio.cierre <- do.call(merge,list)
retornos <- data.frame(apply(precio.cierre, 2, function(x) Delt(x, type = "log")), fecha = index(precio.cierre))
reshape <- melt(retornos, id.vars = "fecha")
g2 <- ggplot(reshape) + geom_line(mapping = aes(fecha,value, color = variable))
g2 <- g2 + labs(title = "Retornos", subtitle = "SITES, WALMART")
g2 <- g2 + theme_bw() + xlab("Fecha") + ylab("Retornos")
g2 <- g2 + scale_color_manual("Tickers", values = c("green", "yellow", "orange", "red", "blue", "purple", "pink"))
g2 <- g2 + theme(legend.position = "bottom")
g2
# VaR del Bono
# Flujo a Valor Presente
vPBono <- vector()
flujoBono <- c(135,135,135,135,135,135,135,135,1135)
yrs <- seq(1,9)
r <- 0.09
wt <- vector()
for (t in yrs){
vPBono[t] <- flujoBono[t]/((1+r)^t)
}
# Precio del Bono
precioBono <- sum(vPBono)
#Calculando el wt
for (t in yrs){
wt[t] <- vPBono[t]/precioBono
}
# Calculando t*wt
twt <- vector()
for (t in yrs){
twt[t] <- t*wt[t]
}
# Calculando la Duración del Bono
D <- sum(twt)
I <- 0.09
# Calculando la Duration* del Bono
DMod <- D/(1+I)
DMod
Z <- -2.32 # Valor de Z de alpha 99% de confianza
vol <- 0.00927 # Volatilidad del bono
VaRBono <- (Z*vol)*DMod*precioBono*I
VaRBono
Rendimiento1<-na.omit(diff(log(precioBono)))
ptVar_Real <- Rendimiento1^2
ptVol_Real <- sqrt(ptVar_Real)
Rendimiento1<-na.omit(diff(log(precioBono)))
ptVar_Real <- Rendimiento1^2
ptVol_Real <- sqrt(ptVar_Real)
ptVol_Real
Rendimiento<-na.omit(diff(log(precioBono)))
ptVar_Real <- Rendimiento^2
ptVol_Real <- sqrt(ptVar_Real)
ptVol_Real
library(readxl)
setwd("C:/Users/theso/OneDrive/Documents/Semestre 6/Analisis de Riesgo/Proyecto-AR-definitivo/Datos")
library(readxl)
setwd("C:/Users/theso/OneDrive/Documents/Semestre 6/Analisis de Riesgo/Proyecto-AR-definitivo/Datos")
TB <- read_xlsx("TB.xlsx")
TB <- subset(TB,SF53883!="N/E")
library(readxl)
setwd("C:/Users/theso/OneDrive/Documents/Semestre 6/Analisis de Riesgo/Proyecto-AR-definitivo/Datos")
TB <- read_xlsx("TB.xlsx")
TB <- subset(TB,SF43883!="N/E")
plot(TB, type="l")
VN <- 2500 #nominal
t <- 3 #vencimiento
tc <- 0.05 #tasas cupon
m <- 2 #frecuencia
n <- nrow(TB)
VN <- 2500 #nominal
t <- 3 #vencimiento
tc <- 0.05 #tasas cupon
m <- 2 #frecuencia
Tasa_Inicial <- TB[n]
n <- nrow(TB)
VN <- 2500 #nominal
t <- 3 #vencimiento
tc <- 0.05 #tasas cupon
m <- 2 #frecuencia
Tasa_Inicial <- TB[n,1]
n <- nrow(TB)
VN <- 2500 #nominal
t <- 3 #vencimiento
tc <- 0.05 #tasas cupon
m <- 2 #frecuencia
Tasa_Inicial <- TB[n,2]
n <- nrow(TB)
VN <- 2500 #nominal
t <- 3 #vencimiento
tc <- 0.05 #tasas cupon
m <- 2 #frecuencia
Tasa_Inicial <- TB[n,2]
Tasa_Inicial
n <- nrow(TB)
VN <- 2500 #nominal
t <- 3 #vencimiento
tc <- 0.05 #tasas cupon
m <- 2 #frecuencia
Tasa_Inicial <- as.numeric(TB[n,2])/100
Tasa_Inicial
flujoBono <- c(2750,2750,2750,2750,2750,2750,2750,57750)
t <- seq(0.5,4,by=0.5)
rf <- 6.5/100
vpBono <- vector()
for (i in seq(length(t))) {
vpBono[i] <- VN/((1+Tasa_Inicial)^t[i])
}
pBonoA <- sum(vpBono)
pBonoA
library(PerformanceAnalytics)
TB$SF43883 <- as.numeric(TB$SF43883)
TB <- xts(TB$SF43883, order.by = date(TB$Fecha))
library(PerformanceAnalytics)
TB$SF43883 <- as.numeric(TB$SF43883)
TB <- xts(TB$SF43883, order.by = date(TB$Fecha))
library(PerformanceAnalytics)
#TB$SF43883 <- as.numeric(TB$SF43883)
TB <- xts(TB$SF43883, order.by = date(TB$Fecha))
library(PerformanceAnalytics)
library(lubridate)
TB$SF43883 <- as.numeric(TB$SF43883)
TB <- xts(TB$SF43883, order.by = date(TB$Fecha))
library(PerformanceAnalytics)
library(lubridate)
TB$SF43883 <- as.numeric(TB$SF43883)
library(PerformanceAnalytics)
library(lubridate)
TB$SF43883 <- as.numeric(TB$SF43883)
library(PerformanceAnalytics)
library(lubridate)
TB$SF43883 <- as.numeric(TB$SF43883)
library(readxl)
setwd("C:/Users/theso/OneDrive/Documents/Semestre 6/Analisis de Riesgo/Proyecto-AR-definitivo/Datos")
TB <- read_xlsx("TB.xlsx")
TB <- subset(TB,SF43883!="N/E")
plot(TB, type="l")
library(PerformanceAnalytics)
library(lubridate)
TB$SF43883 <- as.numeric(TB$SF43883)
TB <- xts(TB$SF43883, order.by = date(TB$Fecha))
Trend <- na.omit(diff(log(TB)))
Tasa_Est <- Tasa_Inicial*(1+Trend)
n <- nrow(TB)
VN <- 2500 #nominal
t <- 3 #vencimiento
tc <- 0.05 #tasas cupon
m <- 2 #frecuencia
Tasa_Inicial <- as.numeric(TB[n,2])/100
library(readxl)
setwd("C:/Users/theso/OneDrive/Documents/Semestre 6/Analisis de Riesgo/Proyecto-AR-definitivo/Datos")
TB <- read_xlsx("TB.xlsx")
TB <- subset(TB,SF43883!="N/E")
plot(TB, type="l")
n <- nrow(TB)
VN <- 2500 #nominal
t <- 3 #vencimiento
tc <- 0.05 #tasas cupon
m <- 2 #frecuencia
Tasa_Inicial <- as.numeric(TB[n,2])/100
Tasa_Inicial
vn <-
library(PerformanceAnalytics)
library(lubridate)
TB$SF43883 <- as.numeric(TB$SF43883)
TB <- xts(TB$SF43883, order.by = date(TB$Fecha))
Trend <- na.omit(diff(log(TB)))
Tasa_Est <- Tasa_Inicial*(1+Trend)
esc_est <- seq(1:(n-1))
Tasa_Est <- as.data.frame(Tasa_Inicial*(1+Trend), row.names = paste("Esc_est", esc_est))
flujos2<-matrix(0, nf, n)
cupon <- vn*tc
